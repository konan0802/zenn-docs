---
title: "Snowflakeとスプレッドシートを同期"
emoji: "👏"
type: "tech"
topics: []
published: false
---

## 1. はじめに：同期タイミングの悩み
#### omnataアプリの同期設定が一定間隔しかできない問題
#### 「自分でボタンを押して好きなときに同期したい！」というアイデア

## 2. 解決策のご紹介：スプシに同期ボタンを作る！
#### Google スプレッドシートとSnowflakeの連携アイデア
#### ボタンを押すと、最新データがSnowflakeに送られる仕組み

## 3. シンプルなシステム構成
#### OAuth認証でSnowflakeに接続
#### GAS（Google Apps Script）でAPIを呼び出し
#### スプレッドシートのメニューにボタンを設置

## 4. 実装の流れをサクッと解説
#### OAuth認証の設定
* Snowflake側の設定と、GAS側のライブラリ利用
#### 専用ユーザー＆カスタムロールの作成
* 安全にAPIアクセスするための基本設定
#### 同期ボタンの作成
* スプレッドシートにメニューを追加して、ボタンで同期実行

## 5. 実際の動作例とポイント
#### ボタンをクリックすると、ポップアップで結果を表示
#### エラー時の対処法や注意点（権限設定など）

## 6. まとめと今後の展望
#### 今回の仕組みで同期タイミングが自由に調整できるように
#### 「みなさんも試してみて！」という呼びかけ
#### 軽く運用のコツや、さらなる改善アイデア